<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <link rel="stylesheet" href="../css/profile.css">
</head>
<body>

    <div class="profile-container">

        <!-- LEFT SIDEBAR -->
        <aside class="sidebar">
            
            <div class="user-section">
                <div class="user-avatar">
                    <span class="avatar-icon">ðŸ‘¤</span>
                </div>

                <h3 class="welcome-text" id="welcomeText">Welcome</h3>
            </div>

            <nav class="menu">
                <a href="#" class="menu-item active" id="menuProfile">Profile</a>
                <a href="#" class="menu-item" id="menuBlogs">Blogs</a>
                <a href="main.html" class="menu-item">Home</a>
                <a href="about.html" class="menu-item">About</a>
                <a href="services.html" class="menu-item">Services</a>
                <a href="#" class="menu-item logout" onclick="logout()">Logout</a>
            </nav>

        </aside>

        <!-- MAIN CONTENT -->
        <main class="content">

            <!-- PROFILE SECTION -->
            <section id="profileSection">
                <h1>User Profile</h1>
                <p>Your personal information is shown below.</p>

                <div class="info-box">
                    <div class="info-row">
                        <label>Full Name:</label>
                        <span id="fullName">Loading...</span>
                    </div>

                    <div class="info-row">
                        <label>Email:</label>
                        <span id="email">Loading...</span>
                    </div>

                    <div class="info-row">
                        <label>Username:</label>
                        <span id="username">Loading...</span>
                    </div>
                </div>
            </section>

            <!-- BLOG SECTION -->
            <section id="blogSection" style="display:none;">
                <h1>Your Blogs</h1>

                <button id="createBlogBtn" class="create-blog-btn">Create New Blog</button>

                <div id="blogList" class="blog-list">
                    <!-- Blogs will be injected here -->
                </div>
            </section>

        </main>

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const user = JSON.parse(localStorage.getItem("user"));

            if (!user) {
                window.location.href = "login.html";
                return;
            }

            // Update profile info
            document.getElementById("welcomeText").textContent = "Welcome, " + user.fullName;
            document.getElementById("fullName").textContent = user.fullName;
            document.getElementById("email").textContent = user.email;
            document.getElementById("username").textContent = user.username;

            // BLOG SYSTEM
            let blogs = JSON.parse(localStorage.getItem("blogs_" + user.username)) || [];

            const menuProfile = document.getElementById("menuProfile");
            const menuBlogs = document.getElementById("menuBlogs");

            const profileSection = document.getElementById("profileSection");
            const blogSection = document.getElementById("blogSection");
            const blogList = document.getElementById("blogList");

            // Switch to Profile View
            menuProfile.addEventListener("click", () => {
                setActive(menuProfile);
                profileSection.style.display = "block";
                blogSection.style.display = "none";
            });

            // Switch to Blog View
            menuBlogs.addEventListener("click", () => {
                setActive(menuBlogs);
                profileSection.style.display = "none";
                blogSection.style.display = "block";
                loadBlogs();
            });

            // Set Active Menu Styling
            function setActive(activeBtn) {
                document.querySelectorAll(".menu-item").forEach(item => item.classList.remove("active"));
                activeBtn.classList.add("active");
            }

            // Load Blogs into List
            function loadBlogs() {
                blogList.innerHTML = "";

                if (blogs.length === 0) {
                    blogList.innerHTML = "<p>No blogs posted yet.</p>";
                    return;
                }

                blogs.forEach(blog => {
                    const card = document.createElement("div");
                    card.classList.add("blog-card");
                    card.innerHTML = `
                        <h3>${blog.title}</h3>
                        <p>${blog.content}</p>
                    `;
                    blogList.appendChild(card);
                });
            }

            // Create Blog Handler
            document.getElementById("createBlogBtn").addEventListener("click", () => {
                const title = prompt("Enter blog title:");
                if (!title) return;

                const content = prompt("Enter blog content:");
                if (!content) return;

                blogs.push({ title, content });
                localStorage.setItem("blogs_" + user.username, JSON.stringify(blogs));

                loadBlogs();
                alert("Blog created!");
            });
        });

        // Logout function
        function logout() {
            localStorage.removeItem("token");
            localStorage.removeItem("user");
            window.location.href = "login.html";
        }
    </script>


</body>
</html>